(()=>{var e=!1,t=!1,n=0,o=!1,a=!1;document.addEventListener("DOMContentLoaded",(function(){var e;e=new MutationObserver((function(e){e.forEach((function(e){if("attributes"===e.type&&"data-clipboard-copied"===e.attributeName){var t=e.target;t&&"true"===t.getAttribute("data-clipboard-copied")&&(console.log("[Clipboard Manager] Clipboard button click detected"),r())}}))})),document.querySelectorAll('[class*="copy"], [class*="clipboard"], button[data-clipboard-text]').forEach((function(t){e.observe(t,{attributes:!0})}))}));var r=function(){t=!0,o=!0,n=Date.now();try{chrome.runtime.sendMessage({action:"copyKeyDetected",hasSelection:""!==window.getSelection().toString().trim(),timestamp:n},(function(e){chrome.runtime.lastError&&console.log("[Clipboard Manager] Runtime error:",chrome.runtime.lastError.message)}))}catch(e){console.log("[Clipboard Manager] Failed to send message - extension context may be invalid")}setTimeout((function(){t=!1}),500),setTimeout((function(){o=!1}),2e3)};document.addEventListener("keydown",(function(e){(function(e){return(e.ctrlKey||e.metaKey)&&("c"===e.key||67===e.keyCode)})(e)&&(console.log("[Clipboard Manager] Copy keyboard shortcut detected"),r()),function(e){return(e.ctrlKey||e.metaKey)&&("v"===e.key||86===e.keyCode)}(e)&&(console.log("[Clipboard Manager] Paste keyboard shortcut detected"),a=!0,t=!0,n=Date.now(),setTimeout((function(){t=!1}),500),setTimeout((function(){a=!1}),2e3),chrome.runtime.sendMessage({action:"pasteKeyDetected",hasSelection:""!==window.getSelection().toString().trim(),timestamp:Date.now()}))}),{passive:!0}),document.addEventListener("copy",(function(){console.log("[Clipboard Manager] Copy event detected"),r()}),{passive:!0}),window.getClipboardManagerState=function(){return{justCopied:t,lastCopyTime:n,hasSelection:""!==window.getSelection().toString().trim(),copyKeyPressed:!0===o,pasteKeyPressed:!0===a}};var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";try{var n=document.createElement("div");n.className="clipboard-manager-notification ".concat(t),n.textContent=e,Object.assign(n.style,{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",padding:"10px 15px",borderRadius:"4px",backgroundColor:"#1e1e1e",color:"#e0e0e0",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)",zIndex:"2147483647",fontSize:"14px",fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, sans-serif",transition:"opacity 0.3s, transform 0.3s",opacity:"0",borderLeft:"4px solid",pointerEvents:"none"}),n.style.borderLeftColor="success"===t?"#4caf50":"error"===t?"#f44336":"#2196f3",document.body.appendChild(n),setTimeout((function(){n.style.opacity="1",n.style.transform="translateX(-50%) translateY(0)"}),10),setTimeout((function(){n.style.opacity="0",n.style.transform="translateX(-50%) translateY(20px)",setTimeout((function(){n&&n.parentNode&&n.parentNode.removeChild(n)}),4e3)}),5e3)}catch(e){console.error("Error showing notification:",e)}},c=function(){if(e){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];(t=console).log.apply(t,["[Clipboard Manager]"].concat(o))}};chrome.runtime.onMessage.addListener((function(t,n,o){try{c("Message received:",t);try{if(!t||!t.action)return c("Ignoring message without action:",t),o({error:"No action specified"}),!0;switch(t.action){case"pasteContent":o({success:function(e){try{c("Attempting to paste content to active element");var t=document.activeElement;if(!t||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)return i("Please focus on an input field, textarea, or editable area","error"),!1;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName){var n=t.selectionStart,o=t.selectionEnd,a=t.value.substring(0,n),r=t.value.substring(o);navigator.clipboard&&"function"==typeof navigator.clipboard.writeText?navigator.clipboard.writeText(e).then((function(){document.execCommand("paste")})).catch((function(){t.value=a+e+r,t.selectionStart=t.selectionEnd=n+e.length,t.dispatchEvent(new Event("input",{bubbles:!0}))})):(t.value=a+e+r,t.selectionStart=t.selectionEnd=n+e.length,t.dispatchEvent(new Event("input",{bubbles:!0})))}else t.isContentEditable&&(navigator.clipboard&&"function"==typeof navigator.clipboard.writeText?navigator.clipboard.writeText(e).then((function(){document.execCommand("paste")})).catch((function(){document.execCommand("insertText",!1,e)})):document.execCommand("insertText",!1,e));return i("Pasted from Clipboard Manager","success"),!0}catch(e){return console.error("Error pasting content:",e),i("Failed to paste content","error"),!1}}(t.content)});break;case"showNotification":i(t.message,t.type),o({success:!0});break;case"toggleVerboseLogging":e=t.enabled,c("Verbose logging "+(e?"enabled":"disabled")),o({success:!0});break;default:c("Unknown action received:",t.action),o({error:"Unknown action"})}return!0}catch(e){console.error("Error handling message:",e);try{o({error:e.message})}catch(e){console.log("[Clipboard Manager] Failed to send response - extension context may be invalid")}return!0}}catch(e){return console.log("[Clipboard Manager] Extension context invalidated or other critical error:",e),!1}})),c("Clipboard Manager content script loaded")})();